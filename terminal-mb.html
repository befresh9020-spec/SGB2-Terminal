<!DOCTYPE html>

<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Roboto+Mono:wght@300;400;600&display=swap" rel="stylesheet">
  <title>SGB II Mehrbedarf Rechner</title>

<style>
  /* ═══════════════════════════════════════════════
     MEHRBEDARF TERMINAL — STYLESHEET
     by Bjørn F.  |  dark HUD / visor aesthetic
     ═══════════════════════════════════════════════ */

  /* ─── CSS CUSTOM PROPERTIES (default: blue) ─── */
  :root {
    --bg-dark:      #050a0a;
    --bg-panel:     rgba(8, 18, 14, 0.93);
    --primary:      #00d4ff;
    --primary-dim:  rgba(0, 212, 255, 0.08);
    --primary-glow: rgba(0, 212, 255, 0.55);
    --primary-mid:  rgba(0, 212, 255, 0.30);
    --text-main:    #c8e8f8;
    --text-dim:     #5a7a8a;
    --success:      #6dffb3;
    --warning:      #ffe066;
    --danger:       #ff4444;
    --border:       rgba(0, 212, 255, 0.30);
    --hex:          rgba(0, 212, 255, 0.05);
    --font-tech:    "Orbitron", sans-serif;
    --font-mono:    "Roboto Mono", monospace;
  }

  /* ─── THEMES ─── */
  [data-theme="blue"] {
    --primary:      #00d4ff;
    --primary-dim:  rgba(0, 212, 255, 0.08);
    --primary-glow: rgba(0, 212, 255, 0.55);
    --primary-mid:  rgba(0, 212, 255, 0.30);
    --text-main:    #c8e8f8;
    --text-dim:     #5a7a8a;
    --border:       rgba(0, 212, 255, 0.30);
    --hex:          rgba(0, 212, 255, 0.05);
  }
  [data-theme="orange"] {
    --primary:      #ff7b00;
    --primary-dim:  rgba(255, 123, 0, 0.08);
    --primary-glow: rgba(255, 123, 0, 0.55);
    --primary-mid:  rgba(255, 123, 0, 0.35);
    --text-main:    #e8dfc0;
    --text-dim:     #8a7a5a;
    --border:       rgba(255, 123, 0, 0.35);
    --hex:          rgba(255, 123, 0, 0.06);
  }
  [data-theme="green"] {
    --primary:      #00ff88;
    --primary-dim:  rgba(0, 255, 136, 0.08);
    --primary-glow: rgba(0, 255, 136, 0.55);
    --primary-mid:  rgba(0, 255, 136, 0.30);
    --text-main:    #c8f0d8;
    --text-dim:     #5a8a6a;
    --border:       rgba(0, 255, 136, 0.30);
    --hex:          rgba(0, 255, 136, 0.05);
  }

  /* ─── RESET ─── */
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  /* ─── BASE ─── */
  body {
    background-color: var(--bg-dark);
    color: var(--text-main);
    font-family: var(--font-tech);
    min-height: 100vh;
    overflow-x: hidden;
    line-height: 1.5;
    -webkit-font-smoothing: antialiased;
    transition: color 0.4s, background-color 0.4s;
  }

  /* ─── CANVAS BACKGROUND ─── */
  #bg-canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: -2;
  }

  /* ─── SCANLINES ─── */
  body::after {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 200%;
    background: repeating-linear-gradient(
      to bottom,
      transparent      0px,
      transparent      2px,
      rgba(0,0,0,0.16) 2px,
      rgba(0,0,0,0.16) 4px
    );
    pointer-events: none;
    z-index: 1001;
    opacity: 0.55;
    animation: scanroll 8s linear infinite;
  }
  @keyframes scanroll { to { transform: translateY(-50%); } }

  /* ─── VISOR EDGE GLOW ─── */
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background:
      linear-gradient(to bottom, var(--primary-dim) 0%, transparent 7%),
      linear-gradient(to top,    var(--primary-dim) 0%, transparent 7%);
    pointer-events: none;
    z-index: 998;
    transition: background 0.5s;
  }

  /* ─── THEME TRANSITION OVERLAY ─── */
  .theme-transition-overlay {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 9999;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .theme-transition-overlay.active { opacity: 1; }
  .theme-transition-overlay::after {
    content: "";
    position: absolute;
    inset: 0;
    background: var(--primary);
    opacity: 0;
    mix-blend-mode: screen;
    animation: pulseGlow 0.8s ease-out;
  }
  @keyframes pulseGlow {
    0%   { opacity: 0;   transform: scale(0.8); }
    50%  { opacity: 0.4; transform: scale(1.1); }
    100% { opacity: 0;   transform: scale(1.5); }
  }

  /* ─── SCROLLBAR ─── */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--primary-mid); border-radius: 3px; }
  ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

  /* ─── CREATOR / TOP BAR ─── */
  .creator-line {
    position: sticky;
    top: 0;
    z-index: 1000;
    text-align: center;
    padding: 10px 24px;
    font-family: var(--font-mono);
    font-size: 0.6rem;
    font-weight: 600;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--primary);
    opacity: 0.75;
    background: rgba(0, 0, 0, 0.88);
    border-bottom: 1px solid var(--border);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px var(--primary-glow);
    transition: color 0.4s, border-color 0.4s, box-shadow 0.4s;
  }

  /* ─── THEME SWITCHER ─── */
  .theme-switcher {
    position: sticky;
    top: 37px; /* below creator-line */
    z-index: 999;
    display: flex;
    background: rgba(0, 0, 0, 0.88);
    border-bottom: 1px solid var(--border);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 20px var(--primary-glow);
    transition: border-color 0.4s, box-shadow 0.4s;
  }

  .theme-btn {
    position: relative;
    flex: 1;
    height: 60px;
    background: transparent;
    border: none;
    border-right: 1px solid rgba(255,255,255,0.07);
    cursor: pointer;
    font-family: var(--font-tech);
    font-weight: 600;
    font-size: 0.62rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 5px;
    transition: background 0.3s, box-shadow 0.3s;
    overflow: hidden;
  }
  .theme-btn:last-child { border-right: none; }

  /* Sweep shimmer on hover */
  .theme-btn::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
    transform: translateX(-100%);
    transition: transform 0.4s;
  }
  .theme-btn:hover::before { transform: translateX(100%); }

  .theme-btn[data-theme="blue"]   { color: #00d4ff; }
  .theme-btn[data-theme="orange"] { color: #ff7b00; }
  .theme-btn[data-theme="green"]  { color: #00ff88; }

  .theme-btn[data-theme="blue"]:hover   { background: rgba(0, 212, 255, 0.08); box-shadow: inset 0 -2px 0 #00d4ff; }
  .theme-btn[data-theme="orange"]:hover { background: rgba(255, 123, 0, 0.08); box-shadow: inset 0 -2px 0 #ff7b00; }
  .theme-btn[data-theme="green"]:hover  { background: rgba(0, 255, 136, 0.08); box-shadow: inset 0 -2px 0 #00ff88; }

  .theme-btn[data-theme="blue"].active   { background: rgba(0, 212, 255, 0.12); box-shadow: inset 0 -3px 0 #00d4ff, 0 0 20px rgba(0,212,255,0.2); }
  .theme-btn[data-theme="orange"].active { background: rgba(255, 123, 0, 0.12); box-shadow: inset 0 -3px 0 #ff7b00, 0 0 20px rgba(255,123,0,0.2); }
  .theme-btn[data-theme="green"].active  { background: rgba(0, 255, 136, 0.12); box-shadow: inset 0 -3px 0 #00ff88, 0 0 20px rgba(0,255,136,0.2); }

  .theme-btn-indicator {
    width: 8px; height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .theme-btn[data-theme="blue"]   .theme-btn-indicator { background: #00d4ff; box-shadow: 0 0 8px #00d4ff; }
  .theme-btn[data-theme="orange"] .theme-btn-indicator { background: #ff7b00; box-shadow: 0 0 8px #ff7b00; }
  .theme-btn[data-theme="green"]  .theme-btn-indicator { background: #00ff88; box-shadow: 0 0 8px #00ff88; }

  /* ─── APP WRAPPER ─── */
  .app {
    position: relative;
    max-width: 800px;
    margin: 36px auto 60px;
    z-index: 10;
    background: var(--bg-panel);
    background-image: radial-gradient(circle, var(--hex) 1px, transparent 1px);
    background-size: 28px 28px;
    border: 1px solid var(--border);
    border-radius: 2px;
    box-shadow:
      0 0 60px rgba(0,0,0,0.75),
      inset 0 0 80px var(--primary-dim),
      0 0 1px var(--primary-mid);
    backdrop-filter: blur(14px);
    overflow: hidden;
    transition: border-color 0.4s, box-shadow 0.4s;
  }

  /* HUD corner brackets — top */
  .app::before,
  .app::after {
    content: "";
    position: absolute;
    width: 28px; height: 28px;
    pointer-events: none;
    z-index: 20;
    transition: border-color 0.4s, box-shadow 0.4s;
  }
  .app::before {
    top: -2px; left: -2px;
    border-top: 2px solid var(--primary);
    border-left: 2px solid var(--primary);
    box-shadow: -2px -2px 12px var(--primary-glow);
  }
  .app::after {
    bottom: -2px; right: -2px;
    border-bottom: 2px solid var(--primary);
    border-right: 2px solid var(--primary);
    box-shadow: 2px 2px 12px var(--primary-glow);
  }

  /* ─── APP HEADER ─── */
  .app-header {
    padding: 28px 36px 22px;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(0,0,0,0.5) 0%, transparent 100%);
    position: relative;
    text-align: center;
    transition: border-color 0.4s;
  }
  /* Glowing centre-line under header */
  .app-header::after {
    content: "";
    position: absolute;
    bottom: -1px; left: 50%;
    transform: translateX(-50%);
    width: 55%; height: 2px;
    background: linear-gradient(90deg, transparent, var(--primary), transparent);
    box-shadow: 0 0 10px var(--primary);
    transition: background 0.4s, box-shadow 0.4s;
  }

  h1 {
    font-size: 1.6rem;
    font-weight: 700;
    letter-spacing: 5px;
    text-transform: uppercase;
    color: var(--primary);
    text-shadow: 0 0 16px var(--primary-glow), 0 0 40px var(--primary-mid);
    margin-bottom: 8px;
    line-height: 1.2;
    transition: color 0.4s, text-shadow 0.4s;
  }
  h4 {
    font-family: var(--font-mono);
    font-size: 0.78rem;
    font-weight: 400;
    color: var(--text-dim);
    letter-spacing: 2px;
    text-transform: uppercase;
    text-align: center;
    transition: color 0.4s;
  }

  /* ─── APP CONTENT ─── */
  .app-content {
    padding: 28px 36px 40px;
  }

  /* ─── REGELBEDARF INFO / INPUT ─── */
  .rb-info {
    background: rgba(0,0,0,0.4);
    border-left: 2px solid var(--primary);
    border-bottom: 1px solid rgba(255,255,255,0.05);
    padding: 12px 18px;
    margin-bottom: 22px;
    font-family: var(--font-mono);
    font-size: 0.85rem;
    color: var(--text-main);
    position: relative;
    transition: border-color 0.4s;
  }
  .rb-info::before {
    content: "";
    position: absolute;
    top: 0; right: 0;
    border-style: solid;
    border-width: 0 14px 14px 0;
    border-color: transparent var(--primary) transparent transparent;
    opacity: 0.45;
    transition: border-color 0.4s;
  }

  #rb-input-wrapper {
    margin-bottom: 22px;
    padding: 16px 18px;
    background: rgba(0,0,0,0.40);
    border: 1px solid var(--border);
    position: relative;
    transition: border-color 0.4s;
    animation: fadeInRB 0.4s ease;
  }
  @keyframes fadeInRB {
    from { opacity: 0; transform: translateY(-8px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  #rb-input-wrapper::before {
    content: "NÄCHSTE STUFE — REGELBEDARF ERMITTELN";
    display: block;
    margin-bottom: 10px;
    font-family: var(--font-mono);
    font-size: 0.6rem;
    letter-spacing: 2px;
    color: var(--text-dim);
  }
  #rb-input-wrapper label {
    display: block;
    margin-bottom: 8px;
    font-family: var(--font-mono);
    font-size: 0.75rem;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--primary);
    transition: color 0.4s;
  }
  #rb-input {
    width: 100%;
    padding: 10px 14px;
    font-family: var(--font-mono);
    font-size: 1rem;
    background: rgba(0,0,0,0.6);
    border: 1px solid var(--border);
    color: var(--success);
    outline: none;
    border-radius: 0;
    transition: border-color 0.25s, box-shadow 0.25s;
    text-shadow: 0 0 8px rgba(109,255,179,0.4);
  }
  #rb-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 16px var(--primary-dim), inset 0 0 10px rgba(109,255,179,0.04);
  }
  #rb-input::placeholder { color: #333; }

  /* ─── CASE TEXT ─── */
  #case-text {
    background: rgba(0,0,0,0.40);
    border-left: 2px solid var(--primary);
    border-bottom: 1px solid rgba(255,255,255,0.05);
    padding: 14px 18px;
    margin-bottom: 24px;
    font-family: var(--font-mono);
    font-size: 0.88rem;
    color: var(--text-main);
    line-height: 1.70;
    position: relative;
    transition: border-color 0.4s;
  }
  #case-text::before {
    content: "";
    position: absolute;
    top: 0; right: 0;
    border-style: solid;
    border-width: 0 16px 16px 0;
    border-color: transparent var(--primary) transparent transparent;
    opacity: 0.45;
    transition: border-color 0.4s;
  }

  /* ─── OPTIONS / PERSONS ─── */
  .persons {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 24px;
  }

  .person {
    background: rgba(0,0,0,0.35);
    border: 1px solid var(--border);
    padding: 16px 18px;
    cursor: pointer;
    transition: all 0.25s;
    position: relative;
    overflow: hidden;
    clip-path: polygon(0 0, calc(100% - 14px) 0, 100% 14px, 100% 100%, 14px 100%, 0 calc(100% - 14px));
    display: flex;
    flex-direction: column;
  }
  /* Sweep shimmer */
  .person::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, var(--primary-dim), transparent);
    transform: translateX(-100%);
    transition: transform 0.45s;
    z-index: 0;
  }
  .person:hover::before { transform: translateX(100%); }
  .person:hover {
    background: var(--primary-dim);
    border-color: var(--primary);
    box-shadow: 0 0 18px var(--primary-dim);
  }
  .person.selected {
    background: rgba(0,0,0,0.55);
    border-color: var(--primary);
    box-shadow: inset 3px 0 0 var(--primary), 0 0 22px var(--primary-dim);
  }
  .person.disabled {
    pointer-events: none;
    opacity: 0.65;
    filter: grayscale(0.2);
  }

  .option-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative;
    z-index: 1;
  }
  .option-header strong {
    font-family: var(--font-mono);
    font-size: 0.88rem;
    font-weight: 600;
    color: var(--text-main);
    line-height: 1.5;
  }
  .person.selected .option-header strong { color: var(--primary); text-shadow: 0 0 8px var(--primary-glow); }

  .checkbox-visual {
    font-family: var(--font-mono);
    font-size: 1rem;
    color: var(--primary);
    text-shadow: 0 0 8px var(--primary-glow);
    white-space: nowrap;
    margin-left: 12px;
    flex-shrink: 0;
    transition: transform 0.2s;
  }
  .person.selected .checkbox-visual { transform: scale(1.1); }

  /* ─── CALC INPUT (inside person card) ─── */
  .calc-input-wrapper {
    display: none;
    margin-top: 16px;
    padding-top: 14px;
    border-top: 1px solid var(--border);
    animation: slideDown 0.35s ease;
    position: relative;
    z-index: 1;
  }
  @keyframes slideDown {
    from { opacity: 0; transform: translateY(-12px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .person.selected .calc-input-wrapper { display: block; }

  .calc-input-label {
    font-family: var(--font-mono);
    font-size: 0.72rem;
    color: var(--warning);
    display: block;
    margin-bottom: 8px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }
  .calc-input {
    background: rgba(0,0,0,0.6);
    border: 1px solid var(--primary);
    color: var(--success);
    padding: 10px 14px;
    font-family: var(--font-mono);
    font-size: 1.05rem;
    font-weight: 600;
    width: 180px;
    outline: none;
    border-radius: 0;
    transition: box-shadow 0.25s, background 0.25s;
    text-shadow: 0 0 8px rgba(109,255,179,0.5);
  }
  .calc-input:focus {
    box-shadow: 0 0 18px var(--primary-dim), inset 0 0 8px rgba(109,255,179,0.04);
    background: rgba(0,0,0,0.8);
  }

  /* ─── ACTION BUTTONS ─── */
  .action-row {
    display: flex;
    gap: 14px;
    padding-top: 20px;
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
    transition: border-color 0.4s;
  }

  button {
    flex: 1;
    background: transparent;
    border: 1px solid var(--primary);
    color: var(--primary);
    font-family: var(--font-tech);
    font-size: 0.72rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    padding: 13px 20px;
    cursor: pointer;
    transition: all 0.25s;
    min-height: 48px;
    position: relative;
    overflow: hidden;
    clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
  }
  /* Glow fill on hover */
  button::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, var(--primary) 0%, transparent 50%);
    opacity: 0;
    transition: opacity 0.3s;
  }
  button:hover::before { opacity: 0.15; }
  button:hover {
    background: var(--primary-dim);
    box-shadow: 0 0 22px var(--primary-glow), inset 0 0 14px var(--primary-dim);
    color: var(--text-main);
    transform: none; /* override old translateY */
  }
  button:active { transform: scale(0.97); }

  /* Secondary / next button */
  #next-btn {
    border-color: var(--border);
    color: var(--text-dim);
  }
  #next-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  button:disabled {
    border-color: rgba(255,255,255,0.1);
    color: rgba(255,255,255,0.2);
    cursor: not-allowed;
    box-shadow: none;
    background: transparent;
  }
  button:disabled::before { display: none; }
  button:disabled:hover { transform: none; box-shadow: none; }

  /* ─── FEEDBACK ─── */
  #feedback {
    margin-top: 24px;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .feedback-item {
    padding: 13px 16px 13px 20px;
    border: 1px solid;
    font-family: var(--font-mono);
    font-size: 0.82rem;
    background: rgba(0,0,0,0.60);
    animation: slideIn 0.35s ease;
    position: relative;
    overflow: hidden;
    line-height: 1.6;
  }
  .feedback-item::before {
    content: "";
    position: absolute;
    top: 0; left: 0; bottom: 0;
    width: 3px;
    background: currentColor;
  }
  .feedback-item strong { display: block; margin-bottom: 4px; }
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(-8px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .feedback-correct { border-color: var(--success); color: var(--success); }
  .feedback-wrong   { border-color: var(--danger);  color: var(--danger);  }
  .feedback-partial { border-color: var(--warning); color: var(--warning); }

  .detail-math {
    display: block;
    margin-top: 10px;
    padding: 8px 12px;
    background: rgba(255,255,255,0.04);
    border-left: 2px solid currentColor;
    color: var(--text-main);
    font-size: 0.82rem;
    font-weight: 600;
    line-height: 1.5;
  }

  /* ─── ZURÜCK-BUTTON ─── */
  .btn-back {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 8px 18px;
    margin: 20px 0 0 0;
    background: transparent;
    border: 1px solid var(--border);
    color: var(--text-dim);
    font-family: var(--font-tech);
    font-size: 0.62rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    text-decoration: none;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
    transition: color 0.25s, border-color 0.25s, box-shadow 0.25s, background 0.25s;
    user-select: none;
  }
  .btn-back::before {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent, var(--primary-dim), transparent);
    transform: translateX(-100%);
    transition: transform 0.4s;
    pointer-events: none;
  }
  .btn-back:hover::before { transform: translateX(100%); }
  .btn-back:hover {
    border-color: var(--primary);
    color: var(--primary);
    background: var(--primary-dim);
    box-shadow: 0 0 16px var(--primary-glow), inset 0 0 10px var(--primary-dim);
  }
  .btn-back-arrow {
    display: inline-block;
    transition: transform 0.25s;
  }
  .btn-back:hover .btn-back-arrow {
    transform: translateX(-4px);
    text-shadow: 0 0 8px var(--primary);
  }
  .btn-back-ripple {
    position: absolute;
    border-radius: 50%;
    background: var(--primary);
    opacity: 0;
    transform: scale(0);
    pointer-events: none;
    width: 10px; height: 10px;
  }
  .btn-back-ripple.active {
    animation: back-ripple-anim 0.5s ease-out forwards;
  }
  @keyframes back-ripple-anim {
    0%   { transform: scale(0);  opacity: 0.5; }
    100% { transform: scale(25); opacity: 0;   }
  }

  /* ─── MOBILE ─── */
  @media (max-width: 768px) {
    .app         { margin: 12px; }
    .app-header  { padding: 20px 18px 16px; }
    .app-content { padding: 18px 16px 32px; }
    h1           { font-size: 1.1rem; letter-spacing: 3px; }
    h4           { font-size: 0.7rem; }
    .action-row  { flex-direction: column; }
    button       { width: 100%; clip-path: none; }
    .person      { clip-path: none; }
    .theme-btn   { font-size: 0.58rem; height: 52px; }
  }
</style>

</head>

<body data-theme="blue">

<canvas id="bg-canvas"></canvas>

<div class="theme-transition-overlay" id="transition-overlay"></div>

<div class="creator-line">
  MEHRBEDARF TERMINAL • SGB II
</div>

<div class="theme-switcher">
  <button class="theme-btn active" data-theme="blue" onclick="switchTheme('blue')">
    <div class="theme-btn-indicator"></div>
    Scan Mode
  </button>
  <button class="theme-btn" data-theme="orange" onclick="switchTheme('orange')">
    <div class="theme-btn-indicator"></div>
    Analyse Mode
  </button>
  <button class="theme-btn" data-theme="green" onclick="switchTheme('green')">
    <div class="theme-btn-indicator"></div>
    Data Mode
  </button>
</div>

<main class="app">
  <div class="app-header">
    <h1>§ 21 SGB II</h1>
    <h4>Wähle den Mehrbedarf und berechne die Höhe.</h4>
  </div>

  <div class="app-content">
    <div id="rb-display" class="rb-info">Lade Daten...</div>

```
<div id="rb-input-wrapper" style="display:none;">
  <label>Maßgebenden Regelbedarf in Euro ermitteln:</label>
  <input type="number" step="0.01" id="rb-input" placeholder="0,00">
</div>

<section id="case-text"></section>
<section id="persons" class="persons"></section>
<section id="feedback"></section>

<div class="action-row">
  <button id="check-btn">Berechnung Prüfen</button>
  <button id="next-btn" onclick="nextCase()">Nächster Fall</button>
</div>
```

<div class="action-row" style="margin-top:0; border-top:none; padding-top:0; justify-content:flex-start;">
  <a href="index.html" class="btn-back" id="btn-back" onclick="triggerBackClick(event)">
    <span class="btn-back-arrow">◄</span>
    Zurück zum Hauptmenü
    <span class="btn-back-ripple" id="back-ripple"></span>
  </a>
</div>

  </div>
</main>

<script>
// =====================================
// THEME SWITCHER
// =====================================
function switchTheme(theme) {
  const overlay = document.getElementById('transition-overlay');
  overlay.classList.add('active');

  setTimeout(() => {
    document.body.setAttribute('data-theme', theme);
    updateParticleColors(theme);

    document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`.theme-btn[data-theme="${theme}"]`).classList.add('active');

    localStorage.setItem('preferredTheme', theme);

    setTimeout(() => overlay.classList.remove('active'), 400);
  }, 300);
}

window.addEventListener('DOMContentLoaded', () => {
  const savedTheme = localStorage.getItem('preferredTheme') || 'blue';
  document.body.setAttribute('data-theme', savedTheme);
  updateParticleColors(savedTheme);
  document.querySelectorAll('.theme-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelector(`.theme-btn[data-theme="${savedTheme}"]`).classList.add('active');
});

// =====================================
// KONFIGURATION & REGELBEDARFE
// =====================================
const RB_ALLEIN    = 563;
const RB_PARTNER   = 506;
const RB_PARTNER_M = 471;
const RB_6_Kind    = 357;
const RB_5_Kind    = 390;

// =====================================
// DATENSATZ
// =====================================
const cases = [
  {
    id: 1,
    baseValue: RB_ALLEIN,
    rbText: "Maßgebender Regelbedarf: 563 € (Alleinstehend)",
    text: "Frau Keller (28) ist im 6. Monat schwanger und lebt allein.",
    options: [
      {
        label: "Schwangerschaft<br>§ 21 Abs. 2 SGB II",
        isCorrect: true, percent: 17, inputRequired: true,
        reason: "Ab der 13. SSW stehen 17% des maßgebenden Regelbedarfs zu."
      },
      {
        label: "Alleinerziehend<br>§ 21 Abs. 3 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Es lebt noch kein Kind im Haushalt."
      },
      {
        label: "Kostenaufwändige Ernährung<br>§ 21 Abs. 5 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Keine Anhaltspunkte."
      }
    ]
  },
  {
    id: 2,
    baseValue: RB_ALLEIN,
    rbText: "Maßgebender Regelbedarf: 563 €",
    text: "Herr Brandt (35) lebt mit zwei Kindern (4 und 7 Jahre) allein in einer Wohnung.",
    options: [
      {
        label: "Alleinerziehend<br>§ 21 Abs. 3 SGB II",
        isCorrect: true, percent: 36, inputRequired: true,
        reason: "Bei 2 Kindern unter 16 Jahren stehen 36% des Regelbedarfs zu."
      },
      {
        label: "Schwangerschaft<br>§ 21 Abs. 2 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Nicht zutreffend, da Herr Brandt nicht schwanger ist."
      },
      {
        label: "Dezentrale Warmwasserversorgung<br>§ 21 Abs. 7 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Nicht zutreffend, da keine Anhaltspunkte hierfür vorliegen."
      }
    ]
  },
  {
    id: 3,
    baseValue: RB_PARTNER,
    requireRbInput: true,
    text: "Frau Müller (30) lebt mit ihrem Ehemann zusammen. Sie ist in der 20. Woche schwanger.",
    options: [
      {
        label: "Laufender, unabweisbarer Bedarf<br>§ 21 Abs. 6 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Keine Anhaltspunkte."
      },
      {
        label: "Alleinerziehend<br>§ 21 Abs. 3 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Sie lebt mit einem Partner zusammen, daher nicht alleinerziehend."
      },
      {
        label: "Schwangerschaft<br>§ 21 Abs. 2 SGB II",
        isCorrect: true, percent: 17, inputRequired: true,
        reason: "Frau Müller ist in der 20. SSW (> 13. SSW). Da sie zusammen mit ihrem Partner lebt, sind 17% aus 506 € zu berechnen."
      }
    ]
  },
  {
    id: 4,
    baseValue: RB_ALLEIN,
    requireRbInput: true,
    text: "Frau Adam (37) lebt mit ihrem Kind (9) gemeinsam in einer Wohnung. Der Vater des Kindes zahlt Unterhalt und beteiligt sich nicht an der Erziehung.",
    options: [
      {
        label: "Schwangerschaft<br>§ 21 Abs. 2 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Frau Adam ist nicht schwanger."
      },
      {
        label: "Alleinerziehend<br>§ 21 Abs. 3 SGB II",
        isCorrect: true, percent: 12, inputRequired: true,
        reason: "Für ein Kind, das älter als 7 Jahre ist, wird ein Mehrbedarf in Höhe von 12 Prozent des maßgebenden Regelbedarfs berücksichtigt."
      },
      {
        label: "Dezentrale Warmwasserversorgung<br>§ 21 Abs. 7 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Keine Anhaltspunkte."
      }
    ]
  },
  {
    id: 5,
    baseValue: RB_ALLEIN,
    requireRbInput: true,
    text: "Herr Zarella lebt in einer Wohnung. Er hat eine Glutenunverträglichkeit (Glutensensitivität), weshalb er auf bestimmte Weizenprodukte verzichten muss. In seinem Badezimmer gibt es einen Durchlauferhitzer.",
    options: [
      {
        label: "Laufender unabweisbarer Bedarf<br>§ 21 Abs. 6 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Es liegt kein laufender unabweisbarer Bedarf vor."
      },
      {
        label: "Kostenaufwändige Ernährung<br>§ 21 Abs. 5 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Bei einer Glutenunverträglichkeit (Glutensensitivität) wird kein Mehrbedarf anerkannt. Nur bei einer diagnostizierten Zöliakie kann ein Mehrbedarf gewährt werden."
      },
      {
        label: "Dezentrale Warmwasserversorgung<br>§ 21 Abs. 7 SGB II",
        isCorrect: true, percent: 2.3, inputRequired: true,
        reason: "Es wird ein Mehrbedarf Warmwasser in Höhe von 2,3 Prozent (des maßgebenden Regelbedarfs von 563 €) gewährt."
      }
    ]
  },
  {
    id: 6,
    baseValue: RB_PARTNER_M,
    requireRbInput: true,
    text: "Frau Yarmolenka (17) ist schwanger. Der voraussichtliche Entbindungstermin ist der 2. März 2026. Sie lebt mit ihrem Partner (19) gemeinsam in einer Wohnung.",
    options: [
      {
        label: "Kostenaufwändige Ernährung<br>§ 21 Abs. 5 SGB II",
        isCorrect: false, percent: 17, inputRequired: false,
        reason: "Es liegen keine Angaben hierzu vor."
      },
      {
        label: "Alleinerziehend<br>§ 21 Abs. 3 SGB II",
        isCorrect: false, percent: 0, inputRequired: false,
        reason: "Sie hat noch kein Kind."
      },
      {
        label: "Schwangerschaft<br>§ 21 Abs. 2 SGB II",
        isCorrect: true, percent: 17, inputRequired: true,
        reason: "Frau Yarmolenka ist in der 39. SSW (> 13. SSW). Da sie minderjährig ist und zusammen mit ihrem volljährigen Partner lebt, sind 17% aus 471 € zu berechnen."
      }
    ]
  }
];

// =====================================
// APP LOGIC
// =====================================
let currentIndex  = 0;
let selectedIndices = [];

const caseTextEl    = document.getElementById("case-text");
const rbDisplayEl   = document.getElementById("rb-display");
const personsEl     = document.getElementById("persons");
const feedbackEl    = document.getElementById("feedback");
const checkBtn      = document.getElementById("check-btn");
const nextBtn       = document.getElementById("next-btn");
const rbInputWrapper = document.getElementById("rb-input-wrapper");
const rbInputEl     = document.getElementById("rb-input");

function loadCase() {
  const currentCase = cases[currentIndex];

  caseTextEl.textContent = currentCase.text;

  if (currentCase.requireRbInput) {
    rbDisplayEl.style.display = "none";
    rbInputWrapper.style.display = "block";
    rbInputEl.value = "";
  } else {
    rbInputWrapper.style.display = "none";
    rbDisplayEl.style.display = "block";
    rbDisplayEl.textContent = currentCase.rbText || "";
  }

  personsEl.innerHTML  = "";
  feedbackEl.innerHTML = "";
  selectedIndices = [];

  checkBtn.style.display  = "block";
  checkBtn.disabled       = false;
  checkBtn.textContent    = "Berechnung Prüfen";
  nextBtn.style.display   = "block";
  nextBtn.disabled        = true;

  currentCase.options.forEach((option, index) => {
    const div = document.createElement("div");
    div.classList.add("person");
    div.dataset.index = index;

    const header = document.createElement("div");
    header.classList.add("option-header");
    header.innerHTML = `
      <strong>${option.label}</strong>
      <span class="checkbox-visual">[ ]</span>
    `;
    div.appendChild(header);

    const inputWrap = document.createElement("div");
    inputWrap.classList.add("calc-input-wrapper");
    inputWrap.innerHTML = `
      <label class="calc-input-label">Betrag in Euro:</label>
      <input type="number" step="0.01" class="calc-input" placeholder="0,00" id="input-${index}">
    `;
    inputWrap.addEventListener("click", e => e.stopPropagation());
    div.appendChild(inputWrap);

    div.addEventListener("click", () => {
      if (checkBtn.disabled) return;

      const checkbox   = div.querySelector(".checkbox-visual");
      const inputField = div.querySelector(`#input-${index}`);

      div.classList.toggle("selected");

      if (div.classList.contains("selected")) {
        checkbox.textContent = "[X]";
        selectedIndices.push(index);
        if (inputField) setTimeout(() => inputField.focus(), 100);
      } else {
        checkbox.textContent = "[ ]";
        selectedIndices = selectedIndices.filter(i => i !== index);
        if (inputField) inputField.value = "";
      }
    });

    personsEl.appendChild(div);
  });
}

checkBtn.addEventListener("click", () => {
  const currentCase = cases[currentIndex];
  let rbBase = currentCase.baseValue;

  if (currentCase.requireRbInput) {
    const enteredRb = parseFloat(rbInputEl.value.replace(',', '.'));

    if (!enteredRb || enteredRb <= 0) {
      alert("Bitte zuerst den maßgebenden Regelbedarf eingeben.");
      return;
    }
    if (enteredRb !== currentCase.baseValue) {
      feedbackEl.innerHTML = `
        <div class="feedback-item feedback-wrong">
          ❌ Der maßgebende Regelbedarf ist falsch.<br>
          Richtig wäre: ${currentCase.baseValue} €
        </div>
      `;
      return;
    }
    rbBase = enteredRb;
  }

  feedbackEl.innerHTML = "";
  document.querySelectorAll('.person').forEach(p => p.classList.add('disabled'));

  let allCorrect = true;

  currentCase.options.forEach((option, index) => {
    const isSelected = selectedIndices.includes(index);
    const inputEl    = document.getElementById(`input-${index}`);
    let userValue    = 0;
    if (inputEl && inputEl.value) userValue = parseFloat(inputEl.value.replace(',', '.'));

    const correctValue = parseFloat((rbBase * (option.percent / 100)).toFixed(2));
    const resDiv = document.createElement("div");
    resDiv.classList.add("feedback-item");

    if (option.isCorrect) {
      if (isSelected) {
        if (Math.abs(userValue - correctValue) < 0.1) {
          resDiv.classList.add("feedback-correct");
          resDiv.innerHTML = `✅ <strong>${option.label}</strong>: Richtig ausgewählt & korrekt berechnet!<br>
            <span class="detail-math">${rbBase} € × ${option.percent}% = ${correctValue.toFixed(2).replace('.', ',')} €</span>`;
        } else {
          resDiv.classList.add("feedback-partial");
          resDiv.innerHTML = `⚠️ <strong>${option.label}</strong>: Richtiger Bedarf, aber falscher Betrag.<br>
            Deine Eingabe: ${userValue.toFixed(2).replace('.', ',')} €<br>
            <span class="detail-math">Richtig wäre: ${rbBase} € × ${option.percent}% = ${correctValue.toFixed(2).replace('.', ',')} €</span>`;
          allCorrect = false;
        }
      } else {
        resDiv.classList.add("feedback-wrong");
        resDiv.innerHTML = `❌ <strong>${option.label}</strong>: Dieser Mehrbedarf wurde vergessen.<br>${option.reason}`;
        allCorrect = false;
      }
    } else {
      if (isSelected) {
        resDiv.classList.add("feedback-wrong");
        resDiv.innerHTML = `❌ <strong>${option.label}</strong>: Dieser Mehrbedarf steht nicht zu.<br>${option.reason}`;
        allCorrect = false;
      }
    }

    if (isSelected || option.isCorrect) feedbackEl.appendChild(resDiv);
  });

  if (feedbackEl.innerHTML === "") {
    feedbackEl.innerHTML = "<div class='feedback-item feedback-correct'>✅ Korrekt! Keine Mehrbedarfe in diesem Fall.</div>";
  }

  checkBtn.disabled = true;
  nextBtn.disabled  = false;
  feedbackEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
});

function nextCase() {
  if (currentIndex < cases.length - 1) {
    currentIndex++;
    loadCase();
    window.scrollTo({ top: 0, behavior: 'smooth' });
  } else {
    caseTextEl.innerHTML  = "<h2 style='color:var(--success); text-align:center; font-size:1.6rem; text-shadow:0 0 20px var(--success); letter-spacing:3px;'>✓ TRAINING ABGESCHLOSSEN</h2><p style='text-align:center; margin-top:14px; color:var(--text-dim); font-family:var(--font-mono); font-size:0.85rem;'>Alle Fälle wurden erfolgreich bearbeitet.</p>";
    rbDisplayEl.style.display = "none";
    personsEl.innerHTML   = "";
    feedbackEl.innerHTML  = "";
    checkBtn.style.display = "none";
    nextBtn.style.display  = "none";
  }
}

loadCase();

// =====================================
// PARTICLE ANIMATION
// =====================================
const canvas = document.getElementById("bg-canvas");
const ctx    = canvas.getContext("2d");
let particles = [];
let currentThemeColor = { r: 0, g: 212, b: 255 };

function resizeCanvas() {
  canvas.width  = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

for (let i = 0; i < 80; i++) {
  particles.push({
    x:       Math.random() * canvas.width,
    y:       Math.random() * canvas.height,
    size:    Math.random() * 2 + 0.5,
    speed:   Math.random() * 0.8 + 0.2,
    opacity: Math.random() * 0.5 + 0.2
  });
}

function updateParticleColors(theme) {
  switch(theme) {
    case 'blue':   currentThemeColor = { r: 0,   g: 212, b: 255 }; break;
    case 'orange': currentThemeColor = { r: 255, g: 123, b: 0   }; break;
    case 'green':  currentThemeColor = { r: 0,   g: 255, b: 136 }; break;
  }
}

function animate() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  particles.forEach(p => {
    ctx.fillStyle = `rgba(${currentThemeColor.r},${currentThemeColor.g},${currentThemeColor.b},${p.opacity})`;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    ctx.fill();
    p.y -= p.speed;
    if (p.y < -10) { p.y = canvas.height + 10; p.x = Math.random() * canvas.width; }
  });
  requestAnimationFrame(animate);
}
// =====================================
// ZURÜCK-BUTTON RIPPLE
// =====================================
function triggerBackClick(e) {
  e.preventDefault();
  const ripple = document.getElementById('back-ripple');
  const btn    = document.getElementById('btn-back');
  const rect   = btn.getBoundingClientRect();
  ripple.style.left = (e.clientX - rect.left - 5) + 'px';
  ripple.style.top  = (e.clientY - rect.top  - 5) + 'px';
  ripple.classList.remove('active');
  void ripple.offsetWidth;
  ripple.classList.add('active');
  setTimeout(() => { window.location.href = 'index.html'; }, 400);
}

animate();
</script>

</body>
</html>